
<h2>Booking List</h2>

<form id="bookingForm">
  <label>Name:</label>
  <input type="text" name="name" required>
  <label>Phone:</label>
  <input type="text" name="phone" required>
  <label>Email:</label>
  <input type="email" name="email" required>
  <button type="submit">Add Booking</button>
</form>

<div id="responseMessage"></div>

<ul id="bookingList">
  <% bookings.forEach(booking => { %>
    <li>
      <%= booking.name %> - <%= booking.phone %> - <%= booking.email %>
      <a href="/edit/<%= booking.id %>">Edit</a>
      <form action="/delete/<%= booking.id %>" method="POST" style="display:inline;">
        <button type="submit">Delete</button>
      </form>
    </li>
  <% }) %>
</ul>

<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script>
  document.getElementById('bookingForm').addEventListener('submit', function(event) {
    event.preventDefault();
    
    const formData = new FormData(this);
    
    axios.post('/add-booking', formData)
      .then(response => {
        if (response.data.success) {
          const newBooking = response.data.booking;
          const bookingList = document.getElementById('bookingList');
          const newBookingItem = document.createElement('li');
          newBookingItem.innerHTML = `
            ${newBooking.name} - ${newBooking.phone} - ${newBooking.email}
            <a href="/edit/${newBooking.id}">Edit</a>
            <form action="/delete/${newBooking.id}" method="POST" style="display:inline;">
              <button type="submit">Delete</button>
            </form>
          `;
          bookingList.appendChild(newBookingItem);
          document.getElementById('responseMessage').textContent = 'Booking added successfully!';
          this.reset();
        } else {
          document.getElementById('responseMessage').textContent = 'Error adding booking!';
        }
      })
      .catch(error => {
        console.error('There was an error!', error);
        document.getElementById('responseMessage').textContent = 'Error adding booking!';
      });
  });
</script>